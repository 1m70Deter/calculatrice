<!DOCTYPE html>
<html>
    <head>
        <title>Calculatrice GUI</title>
        <meta charset="utf-8">
    </head>
    <body>
        <header>
            <div class="binaryBox">
                <p id="binaryP" style="flex: 1;"></p>
                <span style="display : flex; justify-content: flex-end;">
                    <p id="hexP"></p>
                    <p id="heightP"></p>
                </span>
            </div>
            <div class="history">

            </div>
            <h1 id="result"></h1>
        </header>
        <section id=smallCalc style="display: none;">
            <article>
                <div style="width: 20%; display: flex; justify-content: center; align-items: center;">
                    <button class="cButton" onclick="delAll()" style="background: rgb(202, 111, 26); width: 50px; height: 50px; border-radius: 200px;">C</button>
                </div>
                <button onclick="delWord()">Del</button>
                <button>%</button>
                <button>/</button>
                <button>(</button>
            </article>
            <article>
                <button>7</button>
                <button>8</button>
                <button>9</button>
                <button>*</button>
                <button>)</button>
            </article>
            <article>
                <button>4</button>
                <button>5</button>
                <button>6</button>
                <button>-</button>
                <button>e<sup>x</sup></button>
            </article>
            <article>
                <button>1</button>
                <button>2</button>
                <button>3</button>
                <button>+</button>
                <button>root()</button>
            </article>
            <article>
                <button onclick="options()">Opt</button>
                <button>0</button>
                <button>.</button>
                <button onclick="equal()">=</button>
                <button>π</button>
            </article>
        </section>
        <section id="largeCalc">
            <article>
                <div style="width: 15%; display: flex; justify-content: center; align-items: center;">
                    <button class="cButton" onclick="delAll()" style="background: rgb(202, 111, 26); width: 45px; height: 45px; border-radius: 200px;">C</button>
                </div>
                <button onclick="delWord()">Del</button>
                <button title="This is a modulo sign... Not a percent...">%</button>
                <button>/</button>
                <button>(</button>
                <button>ln()</button>
                <button id="moreBtn" onclick="moreFunctions()">More</button>

            </article>
            <article>
                <button>7</button>
                <button>8</button>
                <button>9</button>
                <button>*</button>
                <button>)</button>
                <button>log()</button>
                <button>abs()</button>
            </article>
            <article>
                <button>4</button>
                <button>5</button>
                <button>6</button>
                <button>-</button>
                <button>e<sup>x</sup></button>
                <button>sin()</button>
                <button>sinh()</button>
            </article>
            <article>
                <button>1</button>
                <button>2</button>
                <button>3</button>
                <button>+</button>
                <button>π</button>
                <button>cos()</button>
                <button>cosh()</button>
            </article>
            <article>
                <button onclick="options()">Opt</button>
                <button>0</button>
                <button>.</button>
                <button onclick="equal()">=</button>
                <button title="root(x, [n=2]) : return the n root of x">root()</button>
                <button>tan()</button>
                <button>tanh()</button>
            </article>
        </section>
        <article class="moreAction" style="height: 0px; transition: 300ms; overflow: hidden; overflow-x: auto;">
            <button title="gcd(n1, n2) : return the gcd of two numbers">gcd()</button>
            <button title="lcm(n1, n2) : return the lcm of two numbers">lcm()</button>
            <button title="factor(x) : return the number as a product of factor">factor()</button>
            <button title="sum(f, xval:list, [yval:list], [zval:list]) : return the sum of a function evalued with values in xval">sum()</button>
            <button title="prod(f, xval:list, [yval:list], [zval:list]) : return the product of a function evalued with values in xval">prod()</button>
            <button title="range(min, max, [pas]) : generate a list of numbers between [min; max[">range()</button>
            <button title="dot(u, v, [a]) : return the scalar product of two vectors. [a] can be an angle, if specified, u and v are numbers and not lists">dot()</button>
        </article>
        <article class="logicAction" style="height: 0px; transition: 300ms; overflow: hidden; overflow-x: auto;">
            <button title="NOT(a, b)">NOT</button>
            <button title="OR(a, b)">OR</button>
            <button title="AND(a, b)">AND</button>
            <button title="NOR(a, b)">NOR</button>
            <button title="XOR(a, b)">XOR</button>
            <button title="NAND(a, b)">NAND</button>
            <button title="Enable Binary options" onclick="binaryBox()">Binary</button>
        </article>
        <article class="keyboardAction" style="height: 0px; transition: 300ms; overflow: hidden; overflow-x: auto;">
            <button onclick="options()">Opt</button>
            <div id="modeBox">
                <button onclick="//modifyWriteMode('line')" style="background: white; color: #111;">Line</button>
                <button onclick="//modifyWriteMode('natural')" style="display: none;">Natural</button><!-- comming soon... Maybe... If it's not just a project for the school ! -->
            </div>
        </article>
    </body>
    <div class="optScreenParent">
        <div class="optScreen">
            <div class="optHeader">
                <div id="closeOpt" onclick="options()">
                    <span class="line1"></span>
                    <span class="line2"></span>
                </div>
                <h3>Menu</h3>
            </div>
            <div class="optMain">
                <p id="trueCalc">More Options</p>
                <p onclick="keyboardMode()">Keyboard Mode</p>
                <p id="funcButton">Functions</p>
                <p id="statButton">Statistics</p>
                <p onclick="enableProgrammerMode()">Programmer Mod</p>
                <p id="convButton">Conversion</p>
            </div>
        </div>
    </div>
    <div class="errorScreen">
        <h3>An error occured !</h3>
        <p class="errorText"></p>
    </div>
    <div class="copyMenu" style="display: none;">
        <button onclick="copyResult()">Copy</button>
        <button onclick="pasteSentence()">Paste</button>
    </div>
    <div class="toast" style="bottom: -100px;">
        <p></p>
    </div>
    <p class="titleDiv" style="display: none;"></p>
</html>
<script>
    // Redifining Math functions
    function inRadian(deg) {
        return ((deg * Math.PI) / 180);
    }
    function toNonScientificFormat(num) {
        this.num = num.toString().split("e");
        const power = Number(this.num[1]);
        var nonSci = "";
        if(typeof this.num[1] == "undefined") {
            return num;
        } else if(power < 0) {
            for(i = 0; i < Math.abs(power); i++) {
                nonSci += "0";
                if(i == 0) {
                    nonSci += ".";
                }
            }
            nonSci += this.num[0].split(".")[0] + this.num[0].split(".")[1];
        } else {
            nonSci += this.num[0].split(".")[0] + this.num[0].split(".")[1];
            for(i = 0; i < Math.abs(power); i++) {
                nonSci += "0";
            }
        }
        return nonSci;
    }
    function round(num, dec=1) {
        if(dec == 1) {
            return Number(num.toString().split(".")[0]);
        } else {
            this.num = toNonScientificFormat(num).toString().split(".");
            var rounded = this.num[0] + ".";
            for(var i = 0; i < dec-1; i++) {
                if(typeof this.num[1][i] == "undefined") {
                    break;
                } else {
                    rounded += this.num[1][i];
                }
            }
            return Number(rounded);
        }
    }
    var sin = function(value) { return Math.sin(inRadian(value)); }
    var cos = function(value) { return round(Math.cos(inRadian(value)), 10); }
    var tan = function(value) { return Math.tan(inRadian(value)); }

    var sentence = "", action = [];
    function addInSentence(what) {
        var added; // Must be String
        try {
            whatTesting = Number(what);
            if(whatTesting.toString() == "NaN" || what == "(") {
                console.log(thisIsAnUndefinedVariable);
            }
            added = what.toString();
        } catch(e) {
            if(what == "+" || what == "-" || what == "*" || what == "/" || what == "%" ||  what == ")" || what == ".") {
                added = what;
            } else {
                if(what == "ex") {
                    added = "**";
                } else if(what == "sin()") {
                    added = "sin\(";
                } else if(what == "cos()") {
                    added = "cos\(";
                } else if(what == "tan()") {
                    added = "tan\(";
                } else if(what == "(") {
                    added = "\(";
                } else if(what == "log()") {
                    added = "Math.log\(";
                } else if(what == "sinh()") {
                    added = "Math.sinh\(";
                } else if(what == "cosh()") {
                    added = "Math.cosh\(";
                } else if(what == "tanh()") {
                    added = "Math.tanh\(";
                } else if(what == "ln()") {
                    added = "Math.log1p\(";
                } else if(what == "π") {
                    added = "Math.PI";
                } else if(what == "sqrt()") {
                    added = "Math.sqrt\(";
                } else if(what == "abs()") {
                    added = "Math.abs\(";
                } else if(what == "root()") {
                    added = "root\(";
                } else if(what == "factor()") {
                    added = "factor\(";
                } else if(what == "gcd()") {
                    added = "gcd\(";
                } else if(what == "lcm()") {
                    added = "lcm\(";
                } else if(what == "sum()") {
                    added = "sum\(";
                } else if(what == "prod()") {
                    added = "prod\(";
                } else if(what == "dot()") {
                    added = "dot\(";
                } else if(what == "range()") {
                    added = "createRange\(";
                }
            }
        }
        if(typeof added != "undefined") {
            sentence += added; action[action.length] = added;
            loadToEdit();
            return true;
        } else {
            sentence += what; action[action.length] = what;
            loadToEdit();
            return false;
        }
    }
    function equal() {
        if(sentence != "") {
            try {
                eval(sentence);
            } catch(e) {
                errorScreen("Malformed expression...");
                return false;
            }
            sentence += " = " + eval(sentence).toString();
            loadToEdit();
            p = document.createElement("p");
            p.textContent = sentence; p.setAttribute("onclick", "copyFromHistory(" + document.getElementsByClassName("history")[0].getElementsByTagName("p").length + ")");
            document.getElementsByClassName("history")[0].appendChild(p);
            document.getElementsByClassName("history")[0].appendChild(document.createElement("hr"));
            document.getElementsByClassName("history")[0].scroll(0, 1000000000000000000);
            sentence = ""; action = [];
        }
    }
    function loadToEdit() {
        document.getElementsByTagName("h1")[0].textContent = sentence;
    }
    function delWord() {
        newSentence = "";
        if(sentence == "") {
            return false;
        }
        for(var i = 0; i < (sentence.length - action[action.length-1].length); i++) {
            newSentence += sentence[i];
        }
        sentence = newSentence; action.length -= 1;
        loadToEdit();
    }
    function delAll() {
        if(document.getElementsByTagName("h1")[0].textContent == "") {
            document.getElementsByClassName("history")[0].innerHTML = "";
        } else {
            sentence = ""; action = [];
            loadToEdit();
        }
    }
    for(var i = 0; i < document.getElementsByTagName("button").length; i++) {
        var btn = document.getElementsByTagName("button")[i];
        if(btn.textContent != "Opt" && btn.textContent != "=" && btn.textContent != "C" && btn.textContent != "Del" && btn.textContent != "More" && btn.textContent != "Binary" && btn.textContent != "Line" && btn.textContent != "Natural" && btn.textContent != "Copy" && btn.textContent != "Paste") {
            btn.setAttribute("onclick", "addInSentence('" + btn.textContent/*.split("(")[0]*/ + "')");
        }
    }

    var areOptionsShowed = false;
    function options() {
        if(areOptionsShowed == true) {
            areOptionsShowed = false;
            document.getElementsByClassName("optScreenParent")[0].style.left = "-100%";
            document.getElementsByClassName("optScreen")[0].style.left = "-60%";
        } else {
            areOptionsShowed = true;
            document.getElementsByClassName("optScreenParent")[0].style.left = "0%";
            document.getElementsByClassName("optScreen")[0].style.left = "0%";
        }
    }

    window.onkeypress = function(e) {
        if(e.keyCode == 13 || e.keyCode == 8) {
            return false;
        }
        const rs = addInSentence(e.key);
        if(rs == true) {
            for(var i = 0; i < document.getElementsByTagName("button").length; i++) {
                var thisButton = document.getElementsByTagName("button")[i]
                if(e.key == thisButton.textContent) {
                    thisButton.style = "background: #eee; color: #111;";
                    window.setTimeout(function() {
                        thisButton.style = "";
                    }, 200);
                    break;
                }
            }
        }
        if(e.keyCode == 32) {
            return false;
        }
    }
    window.onkeydown = function(e) {
        if(e.keyCode == 8) {
            if(sentence == "") {
                delAll();
            } else {
                delWord();
            }
        } else if(e.keyCode == 13) {
            equal();
        }
    }

    function errorScreen(msg) {
        document.getElementsByClassName("errorText")[0].textContent = msg;
        document.getElementsByClassName("errorScreen")[0].style.right = "7px";
        window.setTimeout(function() {
            document.getElementsByClassName("errorScreen")[0].style.right = "-300px";
        }, 3000);
    }

    document.getElementById("funcButton").addEventListener("click", function(evt) {
        try {
            pywebview.api.functionWin();
        } catch(e) { errorScreen("Unable To Open New Window"); }
    });
    document.getElementById("trueCalc").addEventListener("click", function(evt) {
        try {
            pywebview.api.moreOptions();
        } catch(e) { errorScreen("Unable To Open New Window"); }
    });
    document.getElementById("convButton").addEventListener("click", function(evt) {
        try {
            pywebview.api.convButton();
        } catch(e) { errorScreen("Unable To Open New Window"); }
    });
    document.getElementById("statButton").addEventListener("click", function(evt) {
        try {
            pywebview.api.statBtn();
        } catch(e) { errorScreen("Unable To Open New Window"); }
    });

    window.setInterval(function() {
        if(document.getElementsByTagName("html")[0].offsetWidth >= 700) {
            document.getElementById("largeCalc").style.display = "block";
            document.getElementById("smallCalc").style.display = "none";
        } else {
            document.getElementById("largeCalc").style.display = "none";
            document.getElementById("smallCalc").style.display = "block";
        }
        if(document.getElementById("result").textContent == "") {
            document.getElementsByClassName("cButton")[0].style = "background: rgb(202, 111, 26); width: 100%; height: 100%; border-radius: 0px;";
            document.getElementsByClassName("cButton")[1].style = "background: rgb(202, 111, 26); width: 100%; height: 100%; border-radius: 0px;";
        } else {
            document.getElementsByClassName("cButton")[0].style = "background: rgb(202, 111, 26); width: 45px; height: 45px; border-radius: 200px;";
            document.getElementsByClassName("cButton")[1].style = "background: rgb(202, 111, 26); width: 45px; height: 45px; border-radius: 200px;";
        }
    }, 300);

    var isActivatedMoreFunc = false;
    function moreFunctions() {
        if(isActivatedMoreFunc) {
            isActivatedMoreFunc = false;
            document.getElementsByClassName("moreAction")[0].style.height = "0px";
        } else {
            isActivatedMoreFunc = true;
            document.getElementsByClassName("moreAction")[0].style.height = "60px";
        }
    }
    // Return the n root of x
    function root(x, n=2) {
        var rs = 0;
        for(var i = 0; i < x; i++) {
            var clc = 1;
            for(var j = 0; j < n; j++) {
                clc *= i;
            }
            if(clc > x) {
                rs = (i-1).toString() + ".";
                break;
            } else if(clc == x) {
                return i;
            }
        }
        while(rs.toString().length < 10) {
            for(var i = 0; i < 10; i++) {
                var rs2 = Number(rs.toString() + i.toString()), clc = 1;
                for(var j = 0; j < n; j++) {
                    clc *= rs2;
                }
                if(clc > x || i == 9) {
                    rs += (i-1).toString();
                    break;
                } else if(clc == x) {
                    return rs+(i-1).toString();
                }
            }
        }
        return Number(rs);
    }
    // Return the gcd of two numbers
    function gcd(n1, n2) {
        var dv1 = [1], dv2 = [1];
        for(var i = 2; i <= n1; i++) {
            if(n1 % i == 0) {
                dv1[dv1.length] = i;
            }
        }
        for(var i = 2; i <= n2; i++) {
            if(n2 % i == 0) {
                dv2[dv2.length] = i;
            }
        }
        var gcdResult1 = 1, gcdResult2 = 1;
        for(var i = 0; i < dv1.length; i++) {
            for(var j = 0; j < dv2.length; j++) {
                if(dv1[i] == dv2[j]) {
                    gcdResult1 = dv1[i];
                }
            }
        }
        for(var i = 0; i < dv2.length; i++) {
            for(var j = 0; j < dv1.length; j++) {
                if(dv2[i] == dv1[j]) {
                    gcdResult2 = dv2[i];
                }
            }
        }
        if(gcdResult1 == gcdResult2) {
            return gcdResult1;
        } else if(gcdResult1 > gcdResult2) {
            return gcdResult1;
        } else {
            return gcdResult2;
        }
    }
    // Return the lcm of two numbers
    function lcm(n1, n2) {
        // n1 will be the lowest int, n2, the greatest
        var ml1 = [], ml2 = [];
        if(n1 > n2) {
            [n1, n2] = [n2, n1];
        } else if(n1 == n2) {
            return n1;
        }
        for(var i = 1; i <= n2; i++) {
            ml1[ml1.length] = n1 * i;
        }
        for(var i = 1; i <= n1; i++) {
            ml2[ml2.length] = n2 * i;
        }
        var lcmResult = n1 * n2;
        for(var i = 0; i < ml1.length; i++) {
            for(var j = 0; j < ml2.length; j++) {
                if(ml1[i] == ml2[j]) {
                    lcmResult = ml1[i];
                    break;
                }
            }
            if(lcmResult != (n1 * n2)) {
                break;
            }
        }
        return lcmResult;
    }
    // Return the number as a product of prime factor (thanks Google translate...)
    function factor(n) {
        var listPrimeNum = [];
        for(var i = 2; i <= n; i++) {
            var dv = [];
            for(var j = 1; j <= i; j++) {
                if(i % j == 0) {
                    dv[dv.length] = j;
                }
            }
            if(dv.length == 2) {
                listPrimeNum[listPrimeNum.length] = i;
            }
        }
        var mltpl = [n], canContinue = false;
        do {
            var mltpl2 = [], canContinue = true;
            for(var i = 0; i < mltpl.length; i++) {
                for(var j = listPrimeNum.length; j >= 0; j--) {
                    if(mltpl[i] == listPrimeNum[j]) {
                        mltpl2[mltpl2.length] = listPrimeNum[j];
                        break;
                    }
                    if(mltpl[i] % listPrimeNum[j] == 0) {
                        mltpl2[mltpl2.length] = mltpl[i] / listPrimeNum[j];
                        mltpl2[mltpl2.length] = listPrimeNum[j];
                        canContinue = false;
                        break;
                    }
                }
            }
            mltpl = mltpl2;
        } while(!canContinue)
        if(mltpl.length == 1) {
            return mltpl;
        } else {
            var sntc = "";
            for(var i = 0; i < mltpl.length; i++) {
                sntc += mltpl[i].toString();
                if(i != mltpl.length-1) {
                    sntc += "*";
                }
            }
            return sntc;
        }
    }
    // Make a vector with coords of two points
    function mkVect(a, b) {
        var u = [b[1]-a[1], b[0]-a[0]];
        return u;
    }
    // Return the norm of a vector
    function norm(u) {
        return root(Math.pow(u[0], 2) + Math.pow(u[1], 2));
    }
    // Return the scalar product of two vectors (a is an angle in deg)
    function sclProd(u, v, a) {
        if(typeof a != "undefined") {
            return norm(u) * norm(v) * cos(a);
        } else {
            return u[0] * v[0] + u[1] * v[1];
        }
    }
    // Return a list of numbers
    function createRange(n1, n2, pas) {
        var L = [];
        if(typeof pas != "undefined") {
            var multiple = 1;
            while(pas < 1) {
                multiple *= 10; pas *= 10; n1 *= 10; n2 *= 10;
            }
            for(var i = n1; i < n2; i += pas) {
                L[L.length] = i / multiple;
            }
        } else {
            for(var i = n1; i <= n2; i++) {
                L[L.length] = i;
            }
        }
        return L;
    }
    // Return the sum using a function f. It can accept three var : x, y and z inside f.
    function sum(f, xval=[], yval=[], zval=[]) {
        var expr = [""], whereInExpr = 0;
        for(i = 0; i < f.length; i++) {
            if(f[i] != "x" && f[i] != "y" && f[i] != "z") {
                expr[whereInExpr] += f[i];
            } else {
                expr[expr.length] = f[i];
                whereInExpr += 2;
                expr[whereInExpr] = "";
            }
        }
        var rs = 0;
        if(yval.length > 0 && zval.length == 0) {
            if(yval.length != xval.length) {
                errorScreen("y list must have the same length than x list");
                return false;
            } else {
                for(var i = 0; i < xval.length; i++) {
                    var x = xval[i], y = yval[i], clc = "";
                    for(var j = 0; j < expr.length; j++) {
                        if(expr[j] != "x" && expr[j] != "y" && expr[j] != "z") {
                            clc += expr[j];
                        } else {
                            if(expr[j] == "x") {
                                clc += x.toString();
                            } else {
                                clc += y.toString();
                            }
                        }
                    }
                    rs += eval(clc);
                }
            }
        } else if(yval.length > 0 && zval.length > 0) {
            if(yval.length != xval.length) {
                errorScreen("y list must have the same length than x list");
                return false;
            } else if(zval.length != xval.length) {
                errorScreen("z list must have the same length than x list");
                return false;
            } else {
                for(var i = 0; i < xval.length; i++) {
                    var x = xval[i], y = yval[i], z = zval[i], clc = "";
                    for(var j = 0; j < expr.length; j++) {
                        if(expr[j] != "x" && expr[j] != "y" && expr[j] != "z") {
                            clc += expr[j];
                        } else {
                            if(expr[j] == "x") {
                                clc += x.toString();
                            } else if(expr[j] == "y") {
                                clc += y.toString();
                            } else {
                                clc += z.toString();
                            }
                        }
                    }
                    rs += eval(clc);
                }
            }
        } else {
            for(var i = 0; i < xval.length; i++) {
                var x = xval[i], clc = "";
                for(var j = 0; j < expr.length; j++) {
                    if(expr[j] != "x" && expr[j] != "y" && expr[j] != "z") {
                        clc += expr[j];
                    } else {
                        clc += x.toString();
                    }
                }
                rs += eval(clc);
            }
        }
        return rs;
    }
    // Like sum, but it's the product... I enjoyed copy + past all text above.
    function prod(f, xval=[], yval=[], zval=[]) {
        var expr = [""], whereInExpr = 0;
        for(i = 0; i < f.length; i++) {
            if(f[i] != "x" && f[i] != "y" && f[i] != "z") {
                expr[whereInExpr] += f[i];
            } else {
                expr[expr.length] = f[i];
                whereInExpr += 2;
                expr[whereInExpr] = "";
            }
        }
        var rs = 1;
        if(yval.length > 0 && zval.length == 0) {
            if(yval.length != xval.length) {
                errorScreen("y list must have the same length than x list");
                return false;
            } else {
                for(var i = 0; i < xval.length; i++) {
                    var x = xval[i], y = yval[i], clc = "";
                    for(var j = 0; j < expr.length; j++) {
                        if(expr[j] != "x" && expr[j] != "y" && expr[j] != "z") {
                            clc += expr[j];
                        } else {
                            if(expr[j] == "x") {
                                clc += x.toString();
                            } else {
                                clc += y.toString();
                            }
                        }
                    }
                    rs *= eval(clc);
                }
            }
        } else if(yval.length > 0 && zval.length > 0) {
            if(yval.length != xval.length) {
                errorScreen("y list must have the same length than x list");
                return false;
            } else if(zval.length != xval.length) {
                errorScreen("z list must have the same length than x list");
                return false;
            } else {
                for(var i = 0; i < xval.length; i++) {
                    var x = xval[i], y = yval[i], z = zval[i], clc = "";
                    for(var j = 0; j < expr.length; j++) {
                        if(expr[j] != "x" && expr[j] != "y" && expr[j] != "z") {
                            clc += expr[j];
                        } else {
                            if(expr[j] == "x") {
                                clc += x.toString();
                            } else if(expr[j] == "y") {
                                clc += y.toString();
                            } else {
                                clc += z.toString();
                            }
                        }
                    }
                    rs *= eval(clc);
                }
            }
        } else {
            for(var i = 0; i < xval.length; i++) {
                var x = xval[i], clc = "";
                for(var j = 0; j < expr.length; j++) {
                    if(expr[j] != "x" && expr[j] != "y" && expr[j] != "z") {
                        clc += expr[j];
                    } else {
                        clc += x.toString();
                    }
                }
                rs *= eval(clc);
            }
        }
        return rs;
    }

    /* This part is for the programmer mode */
    var isProgrammer = false;
    function enableProgrammerMode() {
        if(document.getElementsByTagName("html")[0].offsetWidth <= 700) {
            errorScreen("Must be in \"More options Mode\" !");
            return false;
        }
        if(isProgrammer) {
            isProgrammer = false;
            document.getElementById("moreBtn").setAttribute("onclick", "moreFunctions()");
        } else {
            isProgrammer = true;
            document.getElementById("moreBtn").setAttribute("onclick", "pgmModeFunc()");
            window.setTimeout(function() {
                pgmModeFunc();
            }, 300);
        }
        options();
    }
    var isPgmModeFunc = false;
    function pgmModeFunc() {
        if(isPgmModeFunc) {
            isPgmModeFunc = false;
            document.getElementsByClassName("logicAction")[0].style.height = "0px";
        } else {
            isPgmModeFunc = true;
            if(document.getElementsByTagName("html")[0].offsetWidth >= 700) {
                document.getElementsByClassName("logicAction")[0].style.height = "60px";
            } else {
                errorScreen("Go in \"More options\" mode for using it");
            }
        }
    }
    var isActivatedBinaryBox = false;
    function binaryBox() {
        if(isActivatedBinaryBox) {
            isActivatedBinaryBox = false;
            document.getElementsByClassName("history")[0].style.flex = "1";
            document.getElementsByClassName("binaryBox")[0].style.flex = "0";
        } else {
            isActivatedBinaryBox = true;
            document.getElementsByClassName("history")[0].style.flex = "0";
            document.getElementsByClassName("binaryBox")[0].style.flex = "1";
        }
    }
    function toBinary(n) {
        var inBinary = "";
        while(n > 1) {
            if(n % 2 == 0) {
                inBinary += "0";
            } else {
                inBinary += "1";
            }
            n = Math.floor(n / 2);
        }
        if(n == 1) {
            inBinary += "1";
        }
        var bin = ""
        for(var i = inBinary.length-1; i >= 0; i--) {
            bin += inBinary[i];
        }
        return bin;
    }
    function toHex(n) {
        if(n == 0) {
            return 0;
        }
        var inHex = "", alpha = "0123456789ABCDEF";
        while(n > 1) {
            var moduloResult = n % 16;
            inHex += alpha[moduloResult];
            n = Math.floor(n / 16);
        }
        if(n != 0) {
            inHex += alpha[n];
        }
        var hex = ""
        for(var i = inHex.length-1; i >= 0; i--) {
            hex += inHex[i];
        }
        return hex;
    }
    function toHeightBase(n) {
        if(n == 0) {
            return 0;
        }
        var inHeight = "", alpha = "01234567";
        while(n > 1) {
            var moduloResult = n % 8;
            inHeight += alpha[moduloResult];
            n = Math.floor(n / 8);
        }
        if(n != 0) {
            inHeight += alpha[n];
        }
        var height = ""
        for(var i = inHeight.length-1; i >= 0; i--) {
            height += inHeight[i];
        }
        return height;
    }
    function binToDec(x) {
        this.x = "";
        for(var i = x.length-1; i >= 0; i--) {
            this.x += x[i];
        }
        x = this.x;
        var rs = 0;
        for(var i = 0; i < x.length; i++) {
            if(x[i] == "1") {
                rs += Math.pow(2, i);
            }
        }
        return rs;
    }
    function changeBit(who) {
        var bin = document.getElementById("binaryP").textContent.split(" ").join('').split("");
        if(bin[who] == 0) {
            bin[who] = 1;
        } else {
            bin[who] = 0;
        }
        var dec = binToDec(bin.join('')).toString();
        delAll();
        for(var i = 0; i < dec.length; i++) {
            addInSentence(dec[i]);
        }
    }
    var lastRs = -1;
    window.setInterval(function() {
        if(isActivatedBinaryBox) {
            var rs = document.getElementById("result").textContent;
            if(rs == lastRs) {
                return false;
            } else {
                lastRs = rs;
            }
            if(rs == "") {
                rs = "0";
            } else if(rs.indexOf("=") >= 0) {
                rs = rs.split("=")[1];
            }
            if(Number(rs).toString() == "NaN") {
                return false;
            } else {
                var inBin = toBinary(Number(rs)), inHex = toHex(Number(rs)), inHeight = toHeightBase(Number(rs));
                while(inBin.length < 128) {
                    inBin = "0" + inBin;
                }
                if(!(inBin.length > 128)) {
                    var inBinForP = "";
                    for(var i = 0; i < inBin.length; i++) {
                        if(i % 64 == 0) {
                            inBinForP += "<br />"
                        }
                        else if(i % 8 == 0) {
                            inBinForP += " ";
                        }
                        inBinForP += "<span onclick=\"changeBit(" + i + ")\">" + inBin[i] + "</span>";
                    }
                    document.getElementById("binaryP").innerHTML = inBinForP;
                }
                document.getElementById("hexP").innerHTML = "base<sub>16</sub> = " + inHex;
                document.getElementById("heightP").innerHTML = "base<sub>8</sub> = " + inHeight;
            }
        } else {
            return false;
        }
    }, 100);
    function NOT(x) { if(x % 2 == 0) { return 0; } else { return 1; } }
    function OR() { 
        if(arguments.length > 0) {
            for(i = 0; i < arguments.length; i++) {
                if(arguments[i] % 2 == 1) {
                    return 1;
                }
            }
            return 0;
        }
    }
    function AND() {
        if(arguments.length > 0) {
            for(i = 0; i < arguments.length; i++) {
                if(arguments[i] % 2 == 0) {
                    return 0;
                }
            }
            return 1;
        }
    }
    function NOR() {
        if(arguments.length > 0) {
            for(i = 0; i < arguments.length; i++) {
                if(arguments[i] % 2 == 1) {
                    return 0;
                }
            }
            return 1;
        }
    }
    function XOR() {
        if(arguments.length > 0) {
            var numberOf1 = 0, numberOf0 = 0;
            for(i = 0; i < arguments.length; i++) {
                if(arguments[i] % 2 == 1) {
                    numberOf1 += 1;
                } else {
                    numberOf0 += 1;
                }
            }
            if(numberOf0 > 0 && numberOf1 > 0) {
                return 1;
            } else {
                return 0;
            }
        }
    }
    function NAND() {
        if(arguments.length > 0) {
            for(i = 0; i < arguments.length; i++) {
                if(arguments[i] % 2 == 0) {
                    return 1;
                }
            }
            return 0;
        }
    }

    // This section manage the keyboard mode
    var isEnabledKeyboadMode = false;
    function keyboardMode() {
        if(document.getElementsByTagName("html")[0].offsetWidth <= 700) {
            errorScreen("Must be in \"More options Mode\" !");
            return false;
        }
        options();
        window.setTimeout(function() {
            if(isEnabledKeyboadMode) {
                isEnabledKeyboadMode = false;
                if(document.getElementsByTagName("html")[0].offsetWidth >= 700) {
                    document.getElementById("largeCalc").style.maxHeight = "300px";
                }
                document.getElementsByClassName("keyboardAction")[0].style.height = "0px";
                document.getElementsByTagName("header")[0].style.maxHeight = "60%";
                document.getElementsByClassName("optMain")[0].childNodes[3].removeAttribute("style");
            } else {
                isEnabledKeyboadMode = true;
                if(document.getElementsByTagName("html")[0].offsetWidth >= 700) {
                    document.getElementById("largeCalc").style.maxHeight = "0px";
                }
                document.getElementsByClassName("keyboardAction")[0].style.height = "60px";
                document.getElementsByTagName("header")[0].style.maxHeight = "100%";
                document.getElementsByClassName("optMain")[0].childNodes[3].style.background = "#777";
            }
        }, 300);
    }
    var writeMode = "line";
    function modifyWriteMode(how) {
        if(how == "line") {
            document.getElementById("modeBox").getElementsByTagName("button")[0].style = "background: white; color: #111;";
            document.getElementById("modeBox").getElementsByTagName("button")[1].style = "background: #111; color: white;";
            writeMode = "line";
        } else {
            document.getElementById("modeBox").getElementsByTagName("button")[1].style = "background: white; color: #111;";
            document.getElementById("modeBox").getElementsByTagName("button")[0].style = "background: #111; color: white;";
            writeMode = "natural";
        }
    }
    /* Copy paste func */
    const inputForCopy = document.createElement("input"); inputForCopy.value = ""; inputForCopy.type = "text"; inputForCopy.style.display = "none";
    document.body.appendChild(inputForCopy);
    const toast = document.getElementsByClassName("toast")[0];
    document.getElementsByTagName("h1")[0].addEventListener("contextmenu", function(e) {
        document.getElementsByClassName("copyMenu")[0].style.display = "flex";
        document.getElementsByClassName("copyMenu")[0].style.left = e.clientX + "px"; document.getElementsByClassName("copyMenu")[0].style.top = e.clientY + "px";
        e.stopPropagation();
        return false;
    });
    document.body.addEventListener("click", function() {
        document.getElementsByClassName("copyMenu")[0].style.display = "none";
        return true;
    });
    window.oncontextmenu = function(e) {
        return false;
    }
    function copyResult() {
        inputForCopy.value = document.getElementsByTagName("h1")[0].textContent.split("=")[0];
        toastIt("Copied ! ");
        document.getElementsByClassName("copyMenu")[0].style.display = "none";
    }
    function pasteSentence() {
        if(inputForCopy.value != "") {
            document.getElementsByTagName("h1")[0].textContent = inputForCopy.value;
        }
        toastIt("Pasted ! ");
        document.getElementsByClassName("copyMenu")[0].style.display = "none";
    }
    function copyFromHistory(who) {
        inputForCopy.value = document.getElementsByClassName("history")[0].getElementsByTagName("p")[who].textContent;
        toastIt("Copied ! ");
    }
    function toastIt(msg) {
        toast.textContent = msg; toast.style.left = ((document.body.offsetWidth / 2) - toast.offsetWidth).toString() + "px";
        toast.transition = "300ms";
        window.setTimeout(function() {
            toast.style.bottom = "10px";
            window.setTimeout(function() {
                toast.style.bottom = "-100px";
                window.setTimeout(function() {
                    toast.style.transition = "300ms";
                }, 300);
            }, 2000);
        }, 10);
    }
    if(typeof pywebview == "undefined") {
        var isOveredTitle = false, isOveredButton = false;
        for(var i = 0; i < document.getElementsByTagName("button").length; i++) {
            if(document.getElementsByTagName("button")[i].title != "") {
                document.getElementsByTagName("button")[i].name = document.getElementsByTagName("button")[i].title;
                document.getElementsByTagName("button")[i].title = "";
                document.getElementsByTagName("button")[i].onmousemove = function (e) {
                    isOveredButton = true;
                    document.getElementsByClassName("titleDiv")[0].textContent = e.path[0].name;
                    document.getElementsByClassName("titleDiv")[0].style = "left: " + e.clientX.toString() + "px; top: " + (e.clientY - document.getElementsByClassName("titleDiv")[0].offsetHeight - 30).toString() + "px;";
                    if(e.clientX + document.getElementsByClassName("titleDiv")[0].offsetWidth > document.getElementsByTagName("html")[0].offsetWidth) {
                        document.getElementsByClassName("titleDiv")[0].style.left = (document.getElementsByTagName("html")[0].offsetWidth - document.getElementsByClassName("titleDiv")[0].offsetWidth).toString() + "px";
                    }
                    document.getElementsByClassName("titleDiv")[0].style.display = "flex";
                }
                document.getElementsByTagName("button")[i].onmouseleave = function() {
                    isOveredButton = false;
                    window.setTimeout(function() {
                        if(isOveredTitle == false && isOveredButton == false) {
                            document.getElementsByClassName("titleDiv")[0].style.top = (Number(document.getElementsByClassName("titleDiv")[0].style.top.split("px")[0]) - 6000).toString() + "px";
                            document.getElementsByClassName("titleDiv")[0].style.display = "none"; 
                        }
                    }, 10);
                }
            }
        }
    }
    document.getElementsByClassName("titleDiv")[0].onmouseover = function() {
        isOveredTitle = true;
    }
    document.getElementsByClassName("titleDiv")[0].onmouseleave = function() {
        isOveredTitle = false;
        window.setTimeout(function() {
            if(isOveredButton == false) {
                document.getElementsByClassName("titleDiv")[0].style.display = "none";
            }
        }, 10)
    }
</script>
<style>
    body {
        padding: 0px;
        margin: 0px;
        position: absolute;
        top: 0px;
        left: 0px;
        width: 100%;
        height: 100%;
        background-color: #111;
        overflow: hidden;
        font-family: sans-serif;
        display: flex;
        flex-direction: column;
    }
    header {
        display: flex;
        flex-direction: column;
        flex: 1.15;
        max-height: 60%;
        overflow-y: auto;
    }
    header div {
        height: 99px;
        overflow-y: auto;
        overflow-x: hidden;
        word-wrap: break-word;
        flex: 1;
        transition: 300ms;
    }
    .binaryBox {
        flex: 0;
        font-family: monospace;
        display: flex;
        flex-direction: column;
    }
    #binaryP span {
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        background-color: rgba(0, 0, 0, 0);
        transition: 300ms;
    }
    #binaryP span:hover {
        background-color: #555;
    }
    header p {
        color: #ccc;
        margin: 7px 7px 3px 7px;
        overflow-y: hidden;
        overflow-x: auto;
    }
    header hr {
        background: #333;
        border: none;
        height: 1px;
        margin-left: 3px;
        width: 70%;
    }
    h1 {
        color: white;
        font-weight: normal;
        text-align: end;
        margin: 0px;
        padding: 7px 13px 7px 13px;
        word-wrap: break-word;
        min-height: 50px;
    }
    section {
        transition: 300ms;
        /*flex: 1;*/
        max-height: 300px;
        overflow: hidden;
    }
    article {
        display: flex;
    }
    button {
        width: 20%;
        height: 60px;
        background-color: #111;
        color: #eee;
        border: none;
        font-size: 25px;
        font-weight: normal;
        outline: none;
        user-select: none;
        transition: 200ms;
    }
    button:hover {
        background-color: #eee;
        color: #111;
    }

    #largeCalc button {
        width: 15%;
        height: 60px;
    }
    #modeBox {
        width: 100%; 
        display: flex; 
        justify-content: flex-end;
    }

    .optScreenParent {
        position: absolute;
        top: 0px;
        left: -100%;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        display: flex;
        justify-content: flex-start;
        transition: 300ms;
    }
    .optScreen {
        height: 100%;
        width: 60%;
        max-width: 500px;
        background: #111;
        border-top-right-radius: 7px;
        border-bottom-right-radius: 7px;
        transition: 300ms;
        color: white;
        position: relative;
        left: -60%;
    }
    .optHeader {
        display: flex;
        align-items: center;
    }
    .optHeader h3 {
        flex: 1;
        text-align: left;
        padding-left: 7px;
        font-weight: normal;
        position: relative;
        top: 7px;
    }
    #closeOpt {
        display: flex;
        width: 50px;
        height: 50px;
        cursor: pointer;
        transform: scale(1);
        transition: 200ms;
    }
    #closeOpt:hover {
        transform: scale(1.1);
    }
    #closeOpt:hover .line1, #closeOpt:hover .line2 {
        background: #fff;
    }
    .line1, .line2 {
        width: 40px;
        height: 2px;
        background: #eee;
        border-radius: 200px;
        position: relative;
        top: 30px;
        transition: 200ms;
    }
    .line1 {
        transform: rotate(45deg);
        left: 12px;
    }
    .line2 {
        transform: rotate(-45deg);
        right: 13px;
    }
    .optMain {
        padding: 13px;
        position: relative;
        bottom: 13px;
    }
    .optScreenParent p {
        width: 100%;
        height: 35px;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #333;
        color: #eee;
        transition: 300ms;
        cursor: pointer;
    }
    .optScreenParent p:hover {
        background: #555;
    }

    .errorScreen {
        display: flex;
        flex-direction: column;
        position: fixed;
        top: 7px;
        right: -300px;
        padding: 7px;
        background-color: #333;
        border-radius: 5px;
        width: 250px;
        color: white;
        transition: 350ms;
    }
    .errorScreen h3 {
        margin: 3px 0px 13px 0px;
        width: 100%;
        text-align: center;
    }
    .errorScreen p {
        margin: 0px 0px 0px 3px;
    }

    .copyMenu {
        position: absolute;
        top: 0px;
        left: 0px;
        display: flex;
        flex-direction: column;
        width: 200px;
        height: 60px;
        border: none;
        border-radius: 5px;
        overflow: hidden;
        background-color: #333;
    }
    .copyMenu button {
        background-color: #333;
        color: white;
        border: none;
        font-weight: normal;
        font-size: 16px;
        width: 100%;
        height: 30px;
        display: flex;
        justify-content: flex-start;
        align-items: center;
        cursor: pointer;
        transition: 300ms;
    }
    .copyMenu button:hover {
        background-color: #555;
    }
    .toast {
        position: absolute;
        bottom: 7px;
        min-width: 30px;
        height: 35px;
        border-radius: 200px;
        padding: 0px 13px 0px 13px;
        font-size: 13px;
        font-weight: normal;
        color: white;
        background-color: rgba(80, 80, 80, 0.6);
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .titleDiv {
        position: absolute;
        color: #eee;
        background-color: #333;
        word-wrap: normal;
        min-width: 300px;
        max-width: 400px;
        min-height: 30px;
        font-size: 16px;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 7px;
        border-radius: 5px;
    }
</style>
<script>
    // Nothing here ...
    var isActivatedRgb = false, timerRgb;
    function rgb() {
        if(isActivatedRgb == true) {
            isActivatedRgb = false;
            clearInterval(timerRgb);
        } else {
            isActivatedRgb = true;
            window.setInterval(function() {
                var color = "#" + toHex(Math.floor(Math.random() * 150)+100) + toHex(Math.floor(Math.random() * 150)+100) + toHex(Math.floor(Math.random() * 150)+100);
                for(var j = 0; j < 2; j++) {
                    for(var i = 0; i < document.getElementsByTagName("section")[j].getElementsByTagName("button").length; i++) {
                        if(document.getElementsByTagName("section")[j].getElementsByTagName("button")[i].textContent != "C") {
                            document.getElementsByTagName("section")[j].getElementsByTagName("button")[i].style = "transition: 300ms; border: solid 1px " + color + ";";
                        }
                    }
                }
            }, 300);
        }
    }
</script>
